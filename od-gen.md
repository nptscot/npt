# Generating origin-destination data from first principles


# Introduction

The notes presented here are part of the quality assurance process for
the Network Planning Tool (NPT) project. They should also form the basis
of a more efficient data processing pipeline for the project.

# Current set-up

The OD datasets which form the basis of the NPT are presented below:

| dataset  |   nrow |   trips | mean_lenth | trips_per_row |
|:---------|-------:|--------:|-----------:|--------------:|
| commute  |   1000 |   58623 |       4516 |            59 |
| school   |   1000 |   28978 |       2766 |            29 |
| shopping | 233215 | 2517524 |      11126 |            11 |
| visiting | 219025 |  948228 |       9428 |             4 |
| leisure  | 233221 |  563850 |      10093 |             2 |

Their distance-frequency distributions are presented below:


     commute  leisure   school shopping visiting 
        1000   233221     1000   233215   219025 

![Distance-frequency distribution of origin-destination
datasets](od-gen_files/figure-commonmark/od-distance-freq-1.png)

In terms of number of trips:

![](od-gen_files/figure-commonmark/unnamed-chunk-4-1.png)

# Proposed set-up

We should generate the desired number of trips and associated number of
OD pairs *per distance band* based on analysis of available datasets
before generating desire lines.

The information on the number of desired desire lines per distance band
can be used to sample from available desire lines generated by spatial
interaction models.

The spatial distribution of desire lines should also be explored before
routing.

The proportion of trips made by bike under the baseline scenario for
each origin zone should depend on the proportion of trips made by bike
according to official datasets.

OD datasets can be aggregated to grid cells to reduce routing
requirements.
